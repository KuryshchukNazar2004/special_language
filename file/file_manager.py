import os
import re

def save_to_file(ascii_art):
    """
    Запитує у користувача, чи бажає він зберегти ASCII-арт у файл, і якщо так, зберігає його в текстовий файл.

    Параметри:
    - ascii_art (str): Згенерований ASCII-арт, який буде збережено у файл.

    Процес:
    - Користувач відповідає на запитання, чи хоче він зберегти ASCII-арт.
    - Якщо відповідь позитивна, зберігається файл з назвою, яку введе користувач.
    - Усі кольорові коди (ANSI escape sequences) будуть видалені із ASCII-арту перед збереженням.
    - Файл з ASCII-артом зберігається в директорії `txt_files`.

    Якщо користувач не бажає зберігати ASCII-арт, програма просто повідомить, що збереження не відбулося.
    """
    # Запит на збереження ASCII-арту
    save_option = input("Чи хочете ви зберегти ASCII-арт у файл? (y/n): ").strip().lower()
    
    if save_option == 'y':
        # Отримуємо назву файлу від користувача
        file_name = input("Введіть назву файлу (без розширення): ")
        
        # Створюємо папку для збереження файлів, якщо вона ще не існує
        os.makedirs('txt_files', exist_ok=True) 
        
        # Очищаємо ASCII-арт від кольорових кодів та зберігаємо в текстовий файл
        with open(f"txt_files/{file_name}.txt", 'w', encoding='utf-8') as file:
            # Видаляємо кольорові коди (ANSI escape sequences)
            clean_ascii_art = re.sub(r'\x1b\[[0-?9;]*[mK]', '', ascii_art)
            file.write(clean_ascii_art)
        
        print(f"ASCII-арт збережено у файл txt_files/{file_name}.txt")
    else:
        print("ASCII-арт не збережено.")
